const challenges = [
    { day: 1, title: "ุจุฏุงูุฉ ุงูุจุฑูุฉ", task: "ููุฉ ุงูุตูุงู ููู + ุงูุงุชุตุงู ุจุงูุฌุฏ/ุงูุฌุฏุฉ ูููุจุงุฑูุฉ ุจุงูุดูุฑ + ูุนูููุฉ: ุงููุฏุณ ุนุงุตูุฉ ููุณุทูู ุงูุฃุจุฏูุฉ." },
    { day: 2, title: "ุงูููุฉ ุงูุนุงููุฉ", task: "ุตูุงุฉ ุงูุถุญู (ุฑูุนุชูู) + ุงููุณุงุนุฏุฉ ูู ุฅุนุฏุงุฏ ุงููุทุงูู + ูุนูููุฉ: ูุงุจูุณ ูู ุนุงุตูุฉ ุงูุญูููุงุช ุงูููุณุทูููุฉ." },
    { day: 3, title: "ุตูุฉ ุงูุฑุญู", task: "ุฅุฑุณุงู ุฑุณุงุฆู ุชููุฆุฉ ูู 5 ุฃูุงุฑุจ ูู ุชููููู ููุฐ ูุฏุฉ + ูุนูููุฉ: ูุงูุง ูุงูุช ุชูุณูู 'ุนุฑูุณ ุงูุจุญุฑ'." },
    { day: 4, title: "ููุฑ ุงูููุจ", task: "ูุฑุงุกุฉ ุณูุฑุฉ ุงูููู (ุฅุฐุง ูุงู ุฌูุนุฉ) ุฃู ูุฑุฏ ูู ุงููุฑุขู + ูุนูููุฉ: ุฎุดุจ ุงูุฒูุชูู ูู ุจูุช ูุญู ูููุญุช ููู ุฃุฌูู ุงูุชุญู." },
    { day: 5, title: "ุงูุฌูุฏ ูุงููุฑู", task: "ุชูุฒูุน ุชูุฑ ููุงุก ููุช ุงูุฃุฐุงู ูู ุงูุดุงุฑุน ุฃู ููุฌูุฑุงู + ูุนูููุฉ: ุงูุฎููู ุชุดุชูุฑ ุจุตูุงุนุฉ ุงูุฒุฌุงุฌ ูุงูุฑุณู ุนููู." },
    { day: 6, title: "ุงูุนูู ุงูุณููู", task: "ููู ุจุฏูู ุชุฐูุฑ (ูู ุฅูุฌุงุจูุงู ููุท) + ูุนูููุฉ: ุบุฒุฉ ูุงูุช ูุญุทุฉ ุชุฌุงุฑูุฉ ุชุงุฑูุฎูุฉ ุชุฑุจุท ุขุณูุง ุจุฃูุฑูููุง." },
    { day: 7, title: "ุงูุตุฏูุฉ ุงูุฎููุฉ", task: "ูุถุน ูุจูุบ ุจุณูุท ูู ุตูุฏูู ุตุฏูุฉ ุฃู ูุณุงุนุฏุฉ ูุญุชุงุฌ ุฏูู ุฃู ูุฑุงู ุฃุญุฏ + ูุนูููุฉ: ุฃุฑูุญุง ูู ุฃูุฏู ูุฏููุฉ ูู ุงูุนุงูู." },
    { day: 8, title: "ุงูุฑูู ุจุงูุญููุงู", task: "ูุถุน ูุงุก ุฃู ุทุนุงู ูุญููุงู ูู ุงูุดุงุฑุน + ูุนูููุฉ: ูุฏููุฉ ุตูุฏ ูุงูุช ูุฑูุฒุงู ููุนูู ูุงูุนููุงุก." },
    { day: 9, title: "ุชุฑุงุซ ุงูุฃุฌุฏุงุฏ", task: "ุณุคุงู ูุจุงุฑ ุงูุณู ุนู ูุตุฉ ูู ุชุงุฑูุฎ ููุณุทูู ูุจู ุนุงู 48 + ูุนูููุฉ: ุงูุซูุจ ุงูููุณุทููู ูุฎุชูู ุชุทุฑูุฒู ูู ูุฏููุฉ ูุฃุฎุฑู." },
    { day: 10, title: "ุฐูุฑ ุงููู", task: "ุงูุชุณุจูุญ ูุงูุฐูุฑ 100 ูุฑุฉ ูู ููุช ุงูุณุญุฑ + ูุนูููุฉ: ุทุจุฑูุง ุชูุชูู ุฃุฌูู ุจุญูุฑุฉ ุทุจูุนูุฉ ูู ุจูุงุฏูุง." },
    { day: 11, title: "ุงูุฅูุซุงุฑ", task: "ุงูุชูุงุฒู ุนู ุดูุก ุชุญุจู ูุตุงูุญ ุดุฎุต ุขุฎุฑ + ูุนูููุฉ: ุฌููู ุชูููุจ ุจู 'ุณูุฉ ุฎุถุงุฑ ููุณุทูู'." },
    { day: 12, title: "ุงูุนูู ููุฑ", task: "ูุฑุงุกุฉ 10 ุตูุญุงุช ูู ูุชุงุจ ูููุฏ ุฃู ุณูุงุน ุจูุฏูุงุณุช ุฏููู + ูุนูููุฉ: ููููููุฉ ุชุดุชูุฑ ุจุฃูุถู ุฃููุงุน ุงูุฌูุงูุฉ." },
    { day: 13, title: "ูุธุงูุฉ ุงูุจูุฆุฉ", task: "ุชูุธูู ููุงู ุนุงู ุฃู ุญุฏููุฉ ูุฑูุจุฉ ููู + ูุนูููุฉ: ุงููุฏ ูุงูุฑููุฉ ูุงูุชุง ูุฏูุงู ูุญูุฑูุฉ ูู ุงูุชุฌุงุฑุฉ ุงููุฏููุฉ." },
    { day: 14, title: "ุงูุตูุงุฉ ุนูู ุงููุจู", task: "ุงูุตูุงุฉ ุนูู ุงููุจู 200 ูุฑุฉ ุงูููู + ูุนูููุฉ: ุนูุง ุตูุฏุช ุฃุณูุงุฑูุง ุฃูุงู ูุงุจูููู ุจููุงุจุฑุช." },
    { day: 15, title: "ููุชุตู ุงูุดูุฑ", task: "ุชูููู ุฃูุฏุงูู ุงูุชู ูุถุนุชูุง ุฃูู ุงูุดูุฑ ูุชุฌุฏูุฏ ุงูููุฉ + ูุนูููุฉ: ุงููุณุฌุฏ ุงูุฃูุตู ูู ุฃููู ุงููุจูุชูู." },
    { day: 16, title: "ุงูุนูุฉ", task: "ุบุถ ุงูุจุตุฑ ูุญูุธ ุงููุณุงู ุนู ุงูุบูุจุฉ ุทูุงู ุงูููู + ูุนูููุฉ: ุงูููููุจุฉ ูู ุงูุฃููุฉ ุงูุฃุดูุฑ ูู ุจููุชูุง ุงูููุณุทูููุฉ." },
    { day: 17, title: "ุงูุนูู ุนุจุงุฏุฉ", task: "ุฅุชูุงู ุนููู ุฃู ุฏุฑุงุณุชู ุงูููู ุจุฃูุตู ุทุงูุชู + ูุนูููุฉ: ุงูููุฑููุฉ ูุงูุฒุนุชุฑ ุฌุฒุก ูุง ูุชุฌุฒุฃ ูู ุงูุจูุช ุงูููุณุทููู." },
    { day: 18, title: "ุฏุนุงุก ุจุธูุฑ ุบูุจ", task: "ุงูุฏุนุงุก ูู 3 ุฃุดุฎุงุต ุชุนุฑููู (ุจุงูุงุณู) ุจุงูุฎูุฑ + ูุนูููุฉ: ุฌุจุงู ูุงุจูุณ ุชุญุถู ุงููุฏููุฉ ูุฃููุง ููุจ." },
    { day: 19, title: "ุงูุชูุงุถุน", task: "ุงูุงุนุชุฐุงุฑ ูุดุฎุต ูุฏ ุชููู ุฃุณุฃุช ุฅููู + ูุนูููุฉ: ุจุฆุฑ ุงูุณุจุน ูู ุนุงุตูุฉ ุงูููุจ ูุนุฑุงูุฉ ุงูุจุฏุงูุฉ." },
    { day: 20, title: "ููุงูู ุงูุนุดุฑ", task: "ุงูุงุณุชุนุฏุงุฏ ููุนุดุฑ ุงูุฃูุงุฎุฑ ุจุงูุงุนุชูุงู ุฃู ุฒูุงุฏุฉ ุงูุนุจุงุฏุฉ + ูุนูููุฉ: ูููุณุฉ ุงูููุงูุฉ ูู ุงููุฏุณ ูู ุฃูุฏุณ ุงูุฃูุงูู ูููุณูุญููู." },
    { day: 21, title: "ุชุญุฏู ุงูููุฉ", task: "ููุงุฑุณุฉ ุฑูุงุถุฉ ุฎูููุฉ ูุจู ุงูุฅูุทุงุฑ ุจุณุงุนุฉ + ูุนูููุฉ: ุฒูุช ุงูุฒูุชูู ุงูููุณุทููู ูุนุชุจุฑ ูู ุงูุฃุฌูุฏ ุนุงูููุงู." },
    { day: 22, title: "ุฅูุทุงุฑ ุตุงุฆู", task: "ุฏุนูุฉ ุตุฏูู ุฃู ุบุฑูุจ ููุฅูุทุงุฑ ูุนู + ูุนูููุฉ: ูุฏููุฉ ุจูุณุงู ุชุชููุฒ ุจุขุซุงุฑูุง ุงูุฑููุงููุฉ ุงูุนุธููุฉ." },
    { day: 23, title: "ุงููุฑุขู ุฑุจูุนู", task: "ุญูุธ ุขูุฉ ุฌุฏูุฏุฉ ูุชุฏุจุฑ ูุนูุงูุง + ูุนูููุฉ: ุฌุจู ุฌุฑุฒูู ูุฌุจู ุนูุจุงู ูุญูุทุงู ุจูุงุจูุณ." },
    { day: 24, title: "ุงูููุงุก", task: "ุฒูุงุฑุฉ ูุจูุฑ ุงูููุชู ุฃู ุงูุฏุนุงุก ููู ุจุงูุฑุญูุฉ + ูุนูููุฉ: ูุฏููุฉ ุทูููุฑู ูุงูุช ุชุณูู ูุงุฏู ุงูุดุนูุฑ." },
    { day: 25, title: "ูููุฉ ุงููุฏุฑุ", task: "ุงูุฅูุซุงุฑ ูู ุฏุนุงุก ุงูููู ุฅูู ุนูู ุชุญุจ ุงูุนูู ูุงุนู ุนูู + ูุนูููุฉ: ุงููุณุฌุฏ ุงูุฅุจุฑุงูููู ูู ุงูุฎููู ูู ููุงูุฉ ุนุธููุฉ." },
    { day: 26, title: "ุจุฑ ุงููุงูุฏูู", task: "ุชูุจูู ูุฏ ุงููุงูุฏูู ูุทูุจ ุงูุฑุถุง ูููู + ูุนูููุฉ: ูุฑู ููุณุทูู ุชูุชูู ูุตุต ุตููุฏ ูู ูู ุดุจุฑ." },
    { day: 27, title: "ุตูุงุนุฉ ุงูุฌูุงู", task: "ุฒุฑุน ุดุชูุฉ ุฃู ูุฑุฏุฉ ูู ููุฒูู + ูุนูููุฉ: ุดุฌุฑ ุงูุณุฑู ูุงููููุฑ ูุฒููุงู ุฌุจุงู ุงููุฏุณ." },
    { day: 28, title: "ุดูุฑ ุงููุนู", task: "ูุชุงุจุฉ ูุงุฆูุฉ ุจู 10 ูุนู ุชููููุง ูุดูุฑ ุงููู ุนูููุง + ูุนูููุฉ: ุงูููููุฉ ุงูููุณุทูููุฉ ุฃุตุจุญุช ุฑูุฒุงู ุนุงูููุงู ููุญุฑูุฉ." },
    { day: 29, title: "ูุฏุงุน ุงูุดูุฑ", task: "ุฅุฎุฑุงุฌ ุฒูุงุฉ ุงููุทุฑ ูุชุฌููุฒ ููุงุจุณ ุงูุนูุฏ ููุญุชุงุฌ + ูุนูููุฉ: ุงูุชูุจูุฑุงุช ูู ูุณุงุฌุฏ ููุณุทูู ููุง ูููุฉ ุฎุงุตุฉ." },
    { day: 30, title: "ููู ุงูุฌุงุฆุฒุฉ", task: "ุตูุฉ ุงูุฑุญู ูุงูุชุญุถูุฑ ูุตูุงุฉ ุงูุนูุฏ + ูุนูููุฉ: ููุณุทูู ุณุชุจูู ูู ุงููููุจ ุฏุงุฆูุงู ูุฃุจุฏุงู." }
];


// 2. ุฅุฏุงุฑุฉ ุจูุงูุงุช ุงููุณุชุฎุฏู
let userData = JSON.parse(localStorage.getItem('ramadan_user')) || null;

// 3. ุฏุงูุฉ ุชุณุฌูู ุงููุณุชุฎุฏู
window.registerUser = function() {
    const nameInput = document.getElementById('username-input');
    const name = nameInput.value.trim();
    
    if (name.length < 3) {
        alert("ุงูุฑุฌุงุก ุฅุฏุฎุงู ุงุณู ุญูููู (3 ุญุฑูู ุนูู ุงูุฃูู)");
        return;
    }
    
    userData = {
        name: name,
        points: 0,
        completedDays: []
    };
    
    localStorage.setItem('ramadan_user', JSON.stringify(userData));
    initApp();
};

// 4. ุฏุงูุฉ ุฅูุดุงุก ุงููุฑุจุนุงุช (Grid)
function initGrid() {
    const grid = document.getElementById('grid');
    if (!grid) return;
    grid.innerHTML = '';

    for (let i = 1; i <= 30; i++) {
        const card = document.createElement('div');
        card.className = 'day-card';
        
        // ูุญุต ุงูุฃูุงู ุงูููุชููุฉ
        if (userData && userData.completedDays.includes(i)) {
            card.classList.add('completed');
            card.innerHTML = `<span>${i}</span><small>โ</small>`;
        } else {
            card.innerHTML = `<span>${i}</span>`;
        }

        card.onclick = () => openModal(i);
        grid.appendChild(card);
    }
}

// 5. ูุชุญ ูุฅุบูุงู ุงูููุฏุงู
window.openModal = function(day) {
    if (!userData) {
        alert("ุงูุฑุฌุงุก ุชุณุฌูู ุงุณูู ุฃููุงู ููุฏุฎูู ูู ุงูุชุญุฏู!");
        return;
    }
    window.currentDay = day;
    const ch = challenges.find(c => c.day === day) || { title: `ุงูููู ${day}`, task: "ุชุญุฏู ูุงุฏู!" };
    document.getElementById('modal-title').innerText = ch.title;
    document.getElementById('modal-content').innerText = ch.task;
    document.getElementById('overlay').style.display = 'block';
};

window.toggleModal = function(show) {
    document.getElementById('overlay').style.display = show ? 'block' : 'none';
};

// 6. ุชุณุฌูู ุฅุชูุงู ุงููููุฉ
window.markAsDone = function() {
    if (!userData.completedDays.includes(window.currentDay)) {
        userData.points += 10;
        userData.completedDays.push(window.currentDay);
        localStorage.setItem('ramadan_user', JSON.stringify(userData));
    }
    toggleModal(false);
    initApp();
};

// 7. ุชุญุฏูุซ ููุญุฉ ุงูุตุฏุงุฑุฉ (ูุญุงูุงุฉ ุนุงูููุฉ)
function updateLeaderboard() {
    const list = document.getElementById('leaderboard-list');
    if (!list) return;

    const players = [
        {name: "ูุงุณูู (ุฃููุงููุง)", points: 50},
        {name: "ูุฑูู (ููุฏุง)", points: 40},
        {name: "ุฎุงูุฏ (ุบุฒุฉ)", points: 30}
    ];

    if (userData) {
        players.push({name: userData.name + " (ุฃูุช)", points: userData.points});
    }

    players.sort((a, b) => b.points - a.points);

    list.innerHTML = players.map((p, i) => `
        <li style="${p.name.includes('(ุฃูุช)') ? 'background:#fff9e6; font-weight:bold' : ''}">
            <span>${i+1}. ${p.name}</span>
            <b>${p.points} ๐</b>
        </li>
    `).join('');
}

// 8. ุชุดุบูู ุงูุชุทุจูู
function initApp() {
    if (userData) {
        document.getElementById('auth-section').style.display = 'none';
        document.getElementById('user-display').innerHTML = `
            <span>${userData.name}</span> | <b>${userData.points} ููุทุฉ ๐</b>
        `;
        initGrid();
        updateLeaderboard();
    } else {
        document.getElementById('auth-section').style.display = 'block';
    }
}

// ุงูุจุฏุก ุนูุฏ ุชุญููู ุงูุตูุญุฉ
window.onload = initApp;
